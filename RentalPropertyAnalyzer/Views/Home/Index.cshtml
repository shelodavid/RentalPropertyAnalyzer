 @model List<RentalPropertyAnalyzer.Models.SavedProperties> 
@{
    ViewData["Title"] = "Home Page";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section StatsSection
{
    <div class="row g-3">
        <div class="col-xl-3 col-md-6">
            @await Html.PartialAsync("Partials/_StatCard", ("Saved Properties", (ViewBag.SavedPropertiesCount ?? 0).ToString(), "fas fa-home"), viewData: null)
        </div>
    </div>
}

<div class="container-fluid">
    @await Html.PartialAsync("Partials/_PageHeader", ("Home", "Saved properties overview", null), viewData: null)

    <div class="card shadow-sm">
        <div class="card-header bg-white">
            <h2 class="h6 mb-0">Saved Properties</h2>
        </div>
        <div class="card-body">
            <div class="row g-4">
                @if (Model != null && Model.Any())
                {
                    foreach (var property in Model)
                    {
                        <div class="col-lg-4 col-md-6">
                            <div class="card h-100 shadow-sm">
                                <img class="card-img-top" src="@property.ImgSrc" alt="Property Image">
                                <div class="card-body">
                                    <a href="https://www.zillow.com/homedetails/@(property.ZipID + "_zpid/")" class="card-title d-block fw-semibold text-decoration-none" target="_blank">
                                        @property.StreetAddress
                                    </a>
                                    <div class="row mt-3">
                                        <div class="col-6">
                                            <p class="card-text small mb-1">Price: $@property.Price</p>
                                            <p class="card-text small mb-1">Downpayment: $@property.Downpayment</p>
                                            <p class="card-text small mb-1">Bedrooms: @property.Bedrooms</p>
                                            <p class="card-text small mb-0">Bathrooms: @property.Bathrooms</p>
                                        </div>
                                        <div class="col-6">
                                            <p class="card-text small mb-1">SP-TV Ratio: @property.TVSPRatio</p>
                                            <p class="card-text small mb-1">Rent Estimate $: @property.EstimatedRent</p>
                                            <p class="card-text small mb-1">Monthly Costs $: @property.EstimatedMonthlyCost</p>
                                            <p class="card-text small mb-0">Monthly Profit $: @property.EstimatedMonthlyProfit</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-footer bg-white d-flex justify-content-between gap-2">
                                    <button
                                        type="button"
                                        class="btn btn-primary btn-sm"
                                        onclick="location.href='@Url.Action("GeneratePurchaseSheet", "Home", new { zipID = property.ZipID })'">
                                        Generate Purchase Sheet
                                    </button>

                                    <a href="@Url.Action("DeleteProperty", new { zipID = property.ZipID })" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure you want to delete this property?');">
                                        Delete Property
                                    </a>
                                </div>
                            </div>
                        </div>
                    }
                }
                else
                {
                    <div class="col">
                        <p class="text-muted">No saved properties found.</p>
                    </div>
                }
            </div>
        </div>
    </div>
</div>



                   

