@model RentalPropertyAnalyzer.Models.PurchaseSheetViewModel

@{
    ViewData["Title"] = "Purchase Sheet";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@using (Html.BeginForm("SaveChanges", "Home", FormMethod.Post))
{
    @Html.ValidationSummary(true, "", new { @class = "text-danger" })

    // Hidden fields to preserve property information
    @Html.HiddenFor(m => m.ZipID)
    @Html.HiddenFor(m => m.Price)
    @Html.HiddenFor(m => m.TaxAssessedValue)
    @Html.HiddenFor(m => m.StreetAddress)
    @Html.HiddenFor(m => m.PropertyType)
    @Html.HiddenFor(m => m.Bedrooms)
    @Html.HiddenFor(m => m.Bathrooms)
    @Html.HiddenFor(m => m.ImgSrc)

    @section PurchaseOverviewSection
    {
    <div class="row mb-4">
        <div class="col-md-12">
            <h4>Property Purchase Overview</h4>
        </div>

        <div class="col-md-3">
            <img src="@Model.ImgSrc" alt="Property Image" class="card-img-top">
        </div>
        <div class="col-md-4">
            <p><strong>Address:</strong> @Model.StreetAddress</p>
            <p><strong>Property Type:</strong> @Model.PropertyType</p>
            <p><strong>Bedrooms 🛏️:</strong> @Model.Bedrooms</p>
            <p><strong>Bathrooms 🛁:</strong> @Model.Bathrooms</p>
        </div>
        <div class="col-md-4">
            <p><strong>Price:</strong> @Model.Price.ToString("C")</p>
            <p><strong>Interest Rate:</strong> @Model.MortgageInterestRate.ToString("F2") %</p>
            <p><strong>Mortgage Term:</strong> @Model.Term years</p>
            <p><strong>Downpayment:</strong> @Model.DownpaymentPercentage.ToString("F2") %</p>
            <p><strong>Monthly Payment (P&I):</strong> @Model.EstimatedMortgageCost.ToString("C")</p>
        </div>
    </div>

    }
   
    @section ControlsSection
    {
    <div class="container-fluid">
        <div class="row">
            <!-- COLUMN 1: 4 Sliders -->
            <div class="col-md-4">
                <!-- Slider 1: Downpayment Percentage -->
                <div class="form-group mb-3">
                    <label asp-for="DownpaymentPercentage">Downpayment Percentage</label>
                    <input type="range"
                           asp-for="DownpaymentPercentage"
                           min="0" max="100" step="0.1"
                           class="form-range"
                           oninput="this.nextElementSibling.value = parseFloat(this.value).toFixed(2)" />
                    <output>@Model.DownpaymentPercentage.ToString("F2")</output>
                    <span asp-validation-for="DownpaymentPercentage" class="text-danger"></span>
                </div>

                <!-- Slider 2: Mortgage Interest Rate -->
                <div class="form-group mb-3">
                    <label asp-for="MortgageInterestRate">Interest Rate</label>
                    <input type="range"
                           asp-for="MortgageInterestRate"
                           min="0.1" max="20" step="0.1"
                           class="form-range"
                           oninput="this.nextElementSibling.value = parseFloat(this.value).toFixed(2)" />
                    <output>@Model.MortgageInterestRate.ToString("F2")</output>
                    <span asp-validation-for="MortgageInterestRate" class="text-danger"></span>
                </div>

                <!-- Slider 3: Term -->
                <div class="form-group mb-3">
                    <label asp-for="Term">Term</label>
                    <input type="range"
                           asp-for="Term"
                           min="1" max="30" step="1"
                           class="form-range"
                           oninput="this.nextElementSibling.value = this.value" />
                    <output>@Model.Term</output>
                    <span asp-validation-for="Term" class="text-danger"></span>
                </div>

                <!-- Slider 4: Loan Origination Fee -->
                <div class="form-group mb-3">
                    <label asp-for="LoanOriginationFee">Loan Origination Fee</label>
                    <input type="range"
                           asp-for="LoanOriginationFee"
                           min="0" max="100" step="0.1"
                           class="form-range"
                           oninput="this.nextElementSibling.value = this.value" />
                    <output>@Model.LoanOriginationFee</output>
                </div>
            </div>
            <!-- END COLUMN 1 -->
            <!-- COLUMN 2: 4 Sliders -->
            <div class="col-md-4">
                <!-- Slider 5: Appraisal Fee -->
                <div class="form-group mb-3">
                    <label asp-for="AppraisalFee">Appraisal Fee</label>
                    <input type="range"
                           asp-for="AppraisalFee"
                           min="0" max="5000" step="50"
                           class="form-range"
                           oninput="this.nextElementSibling.value = this.value" />
                    <output>@Model.AppraisalFee</output>
                </div>

                <!-- Slider 6: Credit Report Fee -->
                <div class="form-group mb-3">
                    <label asp-for="CreditReportFee">Credit Report Fee</label>
                    <input type="range"
                           asp-for="CreditReportFee"
                           min="0" max="500" step="10"
                           class="form-range"
                           oninput="this.nextElementSibling.value = this.value" />
                    <output>@Model.CreditReportFee</output>
                </div>

                <!-- Slider 7: Title Insurance Cost -->
                <div class="form-group mb-3">
                    <label asp-for="TitleInsuranceCost">Title Insurance Cost</label>
                    <input type="range"
                           asp-for="TitleInsuranceCost"
                           min="0" max="3000" step="50"
                           class="form-range"
                           oninput="this.nextElementSibling.value = this.value" />
                    <output>@Model.TitleInsuranceCost</output>
                </div>

                <!-- Slider 8: Title Search Fee -->
                <div class="form-group mb-3">
                    <label asp-for="TitleSearchFee">Title Search Fee</label>
                    <input type="range"
                           asp-for="TitleSearchFee"
                           min="0" max="1000" step="25"
                           class="form-range"
                           oninput="this.nextElementSibling.value = this.value" />
                    <output>@Model.TitleSearchFee</output>
                </div>
            </div>
            <!-- END COLUMN 2 -->
            <!-- COLUMN 3: 3 Sliders -->
            <div class="col-md-4">
                <!-- Slider 9: Escrow Fee -->
                <div class="form-group mb-3">
                    <label asp-for="EscrowFee">Escrow Fee</label>
                    <input type="range"
                           asp-for="EscrowFee"
                           min="0" max="5000" step="50"
                           class="form-range"
                           oninput="this.nextElementSibling.value = this.value" />
                    <output>@Model.EscrowFee</output>
                </div>

                <!-- Slider 10: Flood Inspection Fee -->
                <div class="form-group mb-3">
                    <label asp-for="FloodInspectionFee">Flood Inspection Fee</label>
                    <input type="range"
                           asp-for="FloodInspectionFee"
                           min="0" max="1000" step="25"
                           class="form-range"
                           oninput="this.nextElementSibling.value = this.value" />
                    <output>@Model.FloodInspectionFee</output>
                </div>

                <!-- Slider 11: Miscellaneous Fees -->
                <div class="form-group mb-3">
                    <label asp-for="MiscellaneousFees">Miscellaneous Fees</label>
                    <input type="range"
                           asp-for="MiscellaneousFees"
                           min="0" max="5000" step="50"
                           class="form-range"
                           oninput="this.nextElementSibling.value = this.value" />
                    <output>@Model.MiscellaneousFees</output>
                </div>
            </div>
            <!-- END COLUMN 3 -->
        </div>

        <!-- A recalculate (or save) button that posts the form -->

        <div class="row mt-3">
            <div class="col-md-12">
                <button type="submit" class="btn btn-primary">Recalculate</button>
            </div>
        </div>
    </div>
    }







    <div class="row py-4">
        <div class="col-md-12">
            <h3>Itemized Closing Costs</h3>
            <table class="table table-striped costs-table">
                <thead>
                    <tr>
                        <th>Item</th>
                        <th>Amount</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Purchase Price</td>
                        <td>@Model.Price.ToString("C")</td>
                    </tr>
                    <tr>
                        <td>Downpayment (@Model.DownpaymentPercentage.ToString("F2")%)</td>
                        <td>@Model.Downpayment.ToString("C")</td>
                    </tr>
                    <tr>
                        <td>Mortgage Amount</td>
                        <td>@Model.MortgageAmount.ToString("C")</td>
                    </tr>
                    <tr>
                        <td>Monthly Payment (P&I)</td>
                        <td>@Model.EstimatedMortgageCost.ToString("C")</td>
                    </tr>
                    <tr class="table-secondary">
                        <td colspan="2"><strong>Closing Costs</strong></td>
                    </tr>
                    <tr>
                        <td>Loan Origination Fee</td>
                        <td>@Model.LoanOriginationFee.ToString("C")</td>
                    </tr>
                    <tr>
                        <td>Appraisal Fee</td>
                        <td>@Model.AppraisalFee.ToString("C")</td>
                    </tr>
                    <tr>
                        <td>Credit Report Fee</td>
                        <td>@Model.CreditReportFee.ToString("C")</td>
                    </tr>
                    <tr>
                        <td>Title Insurance</td>
                        <td>@Model.TitleInsuranceCost.ToString("C")</td>
                    </tr>
                    <tr>
                        <td>Title Search Fee</td>
                        <td>@Model.TitleSearchFee.ToString("C")</td>
                    </tr>
                    <tr>
                        <td>Escrow Fee</td>
                        <td>@Model.EscrowFee.ToString("C")</td>
                    </tr>
                    <tr>
                        <td>Flood Inspection Fee</td>
                        <td>@Model.FloodInspectionFee.ToString("C")</td>
                    </tr>
                    <tr>
                        <td>Miscellaneous Fees</td>
                        <td>@Model.MiscellaneousFees.ToString("C")</td>
                    </tr>
                    <tr class="table-primary">
                        <td><strong>Total Cash to Close</strong></td>
                        <td><strong>@Model.TotalCost.ToString("C")</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>


}
